(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d21d4fd"],{d182:function(t,a,e){"use strict";e.r(a);var s=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{directives:[{name:"loading",rawName:"v-loading",value:!t.isLoaded,expression:"!isLoaded"}],staticClass:"sc-wp wbs-main",class:{"wb-page-loaded":t.isLoaded}},[e("el-radio-group",{staticClass:"for-tab-nav",attrs:{size:t.$cnf.is_mobile?"medium":"small"},on:{change:function(a){return t.log_type(a)}},model:{value:t.type,callback:function(a){t.type=a},expression:"type"}},[e("el-radio-button",{attrs:{label:101}},[t._v("所有推送")]),e("el-radio-button",{attrs:{label:11}},[t._v("Bing手动推送")]),e("el-radio-button",{attrs:{label:10}},[t._v("Bing自动推送 "),e("i",{staticClass:"tag-pro"},[t._v("Pro")])])],1),e("div",{staticClass:"log-box mt"},[e("el-table",{staticClass:"wbs-table",staticStyle:{width:"100%"},attrs:{data:t.list,"row-key":"id","empty-text":"- 最近7天无推送数据，建议保持每日更新内容 -"}},[e("el-table-column",{attrs:{label:"日期","class-name":"w30"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("div",{staticClass:"data-label",attrs:{"data-label":"发布日期: "}},[t._v(" "+t._s(a.row.date)+" ")])]}}])}),e("el-table-column",{attrs:{label:"链接","class-name":"w40"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("div",{staticClass:"url",attrs:{"data-label":"链接: "}},[t._v(t._s(a.row.url))])]}}])}),e("el-table-column",{attrs:{label:"推送状态"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("div",{staticClass:"data-label",attrs:{"data-label":"推送状态: "},domProps:{innerHTML:t._s(1==a.row.s_push?'<span class="suc">成功</span>':"失败")}})]}}])}),e("el-table-column",{attrs:{label:"推送方式"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("div",{staticClass:"data-label",attrs:{"data-label":"推送方式: "}},[t._v(" "+t._s({10:"自动推送",11:"手动推送"}[a.row.type])+" ")])]}}])})],1),e("div",{staticClass:"btns-bar with-ctrl-area"},[e("div",{staticClass:"wb-ctrl-area"},[e("el-button",{attrs:{type:"danger",icon:"el-icon-s-open",plain:"",size:"mini"},on:{click:function(a){return t.clean_log(t.type)}}},[t._v(" 清除日志 ")])],1),e("el-pagination",{directives:[{name:"show",rawName:"v-show",value:t.list.length>0,expression:"list.length > 0"}],attrs:{background:"",small:!!t.$cnf.is_mobile,layout:t.$cnf.is_mobile?"pager, total, prev, next":"total, prev, pager, next, jumper","page-sizes":[10,30,50,100],"page-size":t.num,total:1*t.total,"pager-count":5},on:{"size-change":t.handleSizeChange,"current-change":t.nav_page}})],1),101==t.type&&"0"==t.opt.bing_auto&&"0"==t.opt.bing_manual?e("div",{staticClass:"getpro-mask"},[e("div",{staticClass:"mask-inner"},[e("el-button",{attrs:{type:"primary",size:"medium"},on:{click:function(a){return t.$router.push({path:"/setting-api"})}}},[t._v("启用收录查询")]),e("p",{staticClass:"tips"},[t._v(" *注意：当前功能依赖Bing推送设置。当前该功能处于关闭状态，需启用后才可使用该功能。 ")])],1)]):t._e(),10==t.type&&t.is_pro&&"0"==t.opt.bing_auto?e("div",{staticClass:"getpro-mask"},[e("div",{staticClass:"mask-inner"},[e("el-button",{attrs:{type:"primary",size:"medium"},on:{click:function(a){return t.$router.push({path:"/setting-api"})}}},[t._v("启用收录查询")]),e("p",{staticClass:"tips"},[t._v(" *注意：当前功能依赖Bing推送设置。当前该功能处于关闭状态，需启用后才可使用该功能。 ")])],1)]):t._e(),10!=t.type||t.is_pro?t._e():e("div",{staticClass:"getpro-mask"},[e("div",{staticClass:"mask-inner"},[e("el-button",{attrs:{type:"primary",size:"medium"},on:{click:t.getPro}},[t._v("获取PRO版本")]),e("p",{staticClass:"tips"},[t._v("* 注意：当前为演示数据，仅供参考")])],1)]),11==t.type?e("div",{staticClass:"pt-l"},[e("el-button",{attrs:{plain:"",size:"mini",type:"primary"},on:{click:t.submit_urls}},[t._v("手动提交链接")])],1):t._e(),11==t.type&&"0"==t.opt.bing_manual?e("div",{staticClass:"getpro-mask"},[e("div",{staticClass:"mask-inner"},[e("el-button",{attrs:{type:"primary",size:"medium"},on:{click:function(a){return t.$router.push({path:"/setting-api"})}}},[t._v("启用Bing手动推送")]),e("p",{staticClass:"tips"},[t._v(" *注意：当前功能依赖Bing推送设置。当前该功能处于关闭状态，需启用后才可使用该功能。 ")])],1)]):t._e()],1),e("wb-prompt",{directives:[{name:"show",rawName:"v-show",value:t.isLoaded,expression:"isLoaded"}],staticClass:"mt"})],1)},i=[];const o="WB_BSL_USER_OPT_"+window.uid;var n={name:"LogBing",data(){const t=this;return{isLoaded:!1,is_pro:t.$cnf.is_pro,opt:t.$opt,type:101,loading_data:-1,list:[],num:10,total:0,page:1}},created(){console.log("-- log-bing -- created ---"),this.$cnf.is_pro&&this.$verify((t,a)=>{this.$cnf.is_pro=t})},mounted(){console.log("-- log-bing -- mounted ---");const t=this,a=t.$WB.getLocalStorage(o)||{};t.num=a["PAGE_SIZE"]||10,t.list=[],t.loadData()},methods:{log_type(t){const a=this;a.type=t,a.page=1,a.total=0,a.list=[],a.loadData()},clean_log(t){const a=this;return a.$wbui.open({content:"确定清除所有推送日志?",btn:["确定","取消"],yes(){a.$api.saveData({_ajax_nonce:window._wb_bsl_ajax_nonce||"",action:a.$cnf.action.act,op:"clean_log",type:t}).then(t=>{a.$wbui.toast("清除成功"),sessionStorage.removeItem("WB_BSL_LOG_BING"),location.reload()})}}),!1},loadData(t=!1){const a=this;let e=a.num||10;if(10==a.type&&!a.is_pro)return a.isLoaded=!0,[];a.showLoading();const s="WB_BSL_LOG_BING",i=a.$WB.getSessionStorage(s,!0);let o=i.data;if(!t&&!a.$WB.updateLocalStorageChecker(i.ver)&&o&&o.num==a.num&&o.list[a.type]&&o.list[a.type][a.page])return a.list=o.list[a.type][a.page],a.total=o.total[a.type],a.closeLoading(),void(a.isLoaded=!0);a.$api.getData({_ajax_nonce:window._wb_bsl_ajax_nonce||"",action:a.$cnf.action.act,op:"push_log",num:e,page:a.page,type:a.type}).then(t=>{a.list=t.data,a.total=t.total,a.closeLoading(),o=a.$WB.getSessionStorage(s)||{list:{},total:{}};try{let i=o.list[a.type]||{},n=o.total;i[a.page]=t.data,n[a.type]=a.total,o.list[a.type]=i,o.total=n,o.num=e,a.$WB.setSessionStorage(s,o),a.isLoaded=!0}catch(i){console.log(i)}}).catch(()=>{a.closeLoading()})},submit_urls(){const t=this;let a=t.$wbui.loading();t.$api.saveData({_ajax_nonce:window._wb_bsl_ajax_nonce||"",action:t.$cnf.action.act,op:"bing_quota"}).then(e=>{if(t.$wbui.close(a),e.code)return void t.$wbui.toast(e.desc);if(!e.data.DailyQuota)return void t.$wbui.toast("当日配额已经用完");const s='<div class="form-group"><textarea id="url_list" class="wbs-input" rows="8" cols="42" placeholder="每行输入一个 URL"></textarea><div class="align-right mt">* 今天的剩余配额: <span class="hl">'+e.data.DailyQuota+"</span> URLs</div></div>",i=t.$wbui.open({title:"手动提交链接",content:s,btn:["确认","取消"],yes(){const a=document.getElementById("url_list").value;if(""===a)return t.$wbui.toast("请输入URL"),!1;t.$api.saveData({_ajax_nonce:window._wb_bsl_ajax_nonce||"",action:t.$cnf.action.act,op:"bing_push_manual",url:a}).then(a=>{a.code?t.$wbui.toast(a.desc):(t.$wbui.toast("提交成功"),t.$wbui.close(i),t.list=[],t.type=11,t.loadData())})}})})},getPro(){this.$router.push({path:"/pro"})},showLoading(){const t=this;t.$wbui.close(t.loading_data),t.loading_data=t.$wbui.loading()},closeLoading(){const t=this;t.$wbui.close(t.loading_data),t.loading_data=-1},nav_page(t){const a=this;a.page=t,a.loadData()},handleSizeChange(t){let a=e.$WB.getLocalStorage(o)||{};const e=this;e.num=t,e.page=1,a["PAGE_SIZE"]=t,e.$WB.setLocalStorage(o,a),sessionStorage.clear(),e.loadData()}}},l=n,c=e("2877"),r=Object(c["a"])(l,s,i,!1,null,null,null);a["default"]=r.exports}}]);